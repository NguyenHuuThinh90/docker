pipeline {
    agent any
    environment {
        MAVEN_PATH = 'k8e-jk-git/pom.xml'
		mvnDir = '/var/jenkins_home/tools_jk/apache-maven-3.6.1/bin/'

    }
	
    stages {
		stage('test-version') {
			steps {
				withMaven(jdk: 'jdk11', maven: 'maven361') {
					script {
						try {
							sh "java -version"
							sh "mvn -version"
						} catch (err) {
							echo err.getMessage()
							echo "No detect version"
						}
					}
				}
			}
		}
		stage('Clean') {
			steps {
				echo "${mvnDir}"
				sh "${mvnDir}mvn -f ${MAVEN_PATH} clean"
			}
		}
        stage('Build') {
            steps {
				withMaven(jdk: 'jdk11'){
					sh "${mvnDir}mvn -f ${MAVEN_PATH} install"
				}
            }
            post {
                success {
                    echo "DONE"
                }
            }
        }
    }
}
